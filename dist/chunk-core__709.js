"use strict";(self.webpackChunk_nextcloud_app_core=self.webpackChunk_nextcloud_app_core||[]).push([["709"],{67580:function(e,t,a){a.r(t),a.d(t,{default:()=>h});var l=a(19632),n=a(91367),u=a(83189),r=a(39438),i=a(90155),s=a(96593),o=a(4943),c=a(40979),m=a(78950);function d(e){if(""===e.trim())return(0,o.t)("Names must not be empty.");if(e.startsWith("."))return(0,o.t)("Names must not start with a dot.");if(e.length>64)return(0,o.t)("Names may be at most 64 characters long.");try{return(0,c.KT)(e),""}catch(e){if(!(e instanceof c.di))throw e;switch(e.reason){case c.nF.Character:return(0,o.t)('"{char}" is not allowed inside a name.',{char:e.segment});case c.nF.ReservedName:return(0,o.t)('"{segment}" is a reserved name and not allowed.',{segment:e.segment});case c.nF.Extension:if(e.segment.match(/\.[a-z]/i))return(0,o.t)('"{extension}" is not an allowed name.',{extension:e.segment});return(0,o.t)('Names must not end with "{extension}".',{extension:e.segment});default:return(0,o.t)("Invalid name.")}}}let p={key:0,class:"public-auth-prompt__text"},f=(0,l.pM)({__name:"PublicAuthPrompt",props:{nickname:{default:""},title:{default:(0,o.t)("Guest identification")},text:{default:""},notice:{default:""},submitLabel:{default:(0,o.t)("Submit name")},cancellable:{type:Boolean}},emits:["close"],setup(e,{emit:t}){let a=(0,l.rk)("input"),c=(0,u.getBuilder)("public").build(),m=(0,l.KR)(e.nickname);(0,l.wB)(()=>e.nickname,()=>{m.value=e.nickname}),(0,l.wB)(m,e=>{let t=d(e);if(!t){a.value.setCustomValidity(t),a.value.reportValidity(),a.value.focus();return}});let f=(0,l.EW)(()=>{let a={label:(0,o.t)("Cancel"),variant:"tertiary",callback:()=>t("close")},l={label:e.submitLabel,type:"submit",variant:"primary"};return e.cancellable?[a,l]:[l]}),h=(0,l.EW)(()=>e.notice?e.notice:m.value?(0,o.t)("You are currently identified as {nickname}.",{nickname:m.value}):(0,o.t)("You are currently not identified."));function b(){let e=m.value.trim(),l=d(e);if(l){a.value.setCustomValidity(l),a.value.reportValidity(),a.value.focus();return}if(""===e){a.value.setCustomValidity((0,o.t)("You cannot leave the name empty.")),a.value.reportValidity(),a.value.focus();return}if(e.length<2){a.value.setCustomValidity((0,o.t)("Please enter a name with at least 2 characters.")),a.value.reportValidity(),a.value.focus();return}try{(0,n.L$)(e)}catch(e){o.l.error("Failed to set nickname",{error:e}),(0,o.s)((0,o.t)("Failed to set nickname.")),a.value.focus();return}c.setItem("public-auth-prompt-shown","true"),t("close",m.value)}return(e,t)=>((0,l.uX)(),(0,l.Wv)((0,l.R1)(r.A),{buttons:f.value,class:"public-auth-prompt","data-cy-public-auth-prompt-dialog":"","is-form":"","no-close":"",name:e.title,onSubmit:b},{default:(0,l.k6)(()=>[e.text?((0,l.uX)(),(0,l.CE)("p",p,(0,l.v_)(e.text),1)):(0,l.Q3)("",!0),(0,l.bF)((0,l.R1)(i.A),{class:"public-auth-prompt__header",text:h.value,type:"info"},null,8,["text"]),(0,l.bF)((0,l.R1)(s.A),{ref:"input",modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=e=>m.value=e),class:"public-auth-prompt__input","data-cy-public-auth-prompt-dialog-name":"",label:(0,l.R1)(o.t)("Name"),placeholder:(0,l.R1)(o.t)("Enter your name"),required:!e.cancellable,minlength:"2",maxlength:"64",name:"name"},null,8,["modelValue","label","placeholder","required"])]),_:1},8,["buttons","name"]))}}),h=(0,m._)(f,[["__scopeId","data-v-b33d88e5"]])}}]);
//# sourceMappingURL=chunk-core__709.js.map